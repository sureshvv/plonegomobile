<metal:page define-macro="master"><tal:doctype tal:replace="structure context/@@viewlets/doctype" />

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal" 
      tal:attributes="xml:lang context/@@plone_portal_state/language; lang context/@@plone_portal_state/language"
      tal:define="portal_state context/@@plone_portal_state;
                  context_state context/@@plone_context_state;
                  plone_view context/@@plone;
                  lang portal_state/language;
                  view nocall:view | nocall: plone_view;
                  dummy python: plone_view.mark_view(view);
                  portal_url portal_state/portal_url;
                  checkPermission nocall: context/portal_membership/checkPermission;
                  site_properties context/portal_properties/site_properties;
                  ajax_load request/ajax_load | nothing"> 
      	
    <metal:cache use-macro="context/global_cache_settings/macros/cacheheaders">
        Get the global cache headers located in global_cache_settings.
    </metal:cache>

    <head>
		<metal:block tal:replace="structure context/@@viewlets/head" />
	
  		<tal:comment replace="nothing"> A slot where you can insert CSS in the header from a template </tal:comment>
  		<metal:styleslot define-slot="style_slot" />
	</head>

  <body tal:define="isRTL portal_state/is_rtl;
                    body_class python:plone_view.bodyClass(template, view);
		    simulator context/@@mobile_tool/isPreviewRequest|python:False;
		    simulator_class python:simulator and 'mobile-preview' or 'mobile-real'"
        tal:attributes="class string:$body_class $simulator_class;
                        dir python: isRTL and 'rtl' or 'ltr'">

        <div id="margins">

            <div tal:replace="structure context/@@viewlets/header" />
            <div tal:replace="structure context/@@viewlets/actionsheader" />

            <div id="content">
                <metal:block define-slot="content">
                    <div metal:define-macro="content">

                        <div tal:replace="structure context/@@viewlets/messages">
                          <tal:comment replace="nothing">Portal status message</tal:comment>
                        </div>

                        <metal:slot metal:define-slot="body">

                              <metal:header metal:define-slot="header" tal:content="nothing">
                                <tal:comment replace="nothing">Visual Header</tal:comment>
                              </metal:header>

                              <metal:bodytext metal:define-slot="main" tal:content="nothing">
                                <tal:comment replace="nothing">Page body text</tal:comment>
                              </metal:bodytext>

                        </metal:slot>

                         <div tal:replace="structure context/@@viewlets/mobilefolderlisting" />

                        <metal:sub metal:define-slot="sub">
                        </metal:sub>


                    </div>
                </metal:block>
            </div>

          <div tal:replace="structure context/@@viewlets/searchboxbottom" />

          <div tal:replace="structure context/@@viewlets/navigation" />

          <div tal:replace="structure context/@@viewlets/footer" />
          </div>
    </body>
</html>
</metal:page>
